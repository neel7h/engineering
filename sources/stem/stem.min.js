/*! stem - 0.4.0.dev, built on 18-06-2015 */
(function(){var a,b,c,d,e,f,g,h,i,j=[].slice;a=function(){function a(){this.channels={}}return a.prototype.on=function(b,c,d){var e,f,g,h,i,j,k,l,m,n,o;if(null==d&&(d=this),b instanceof Array){if("function"!=typeof c)return!1;for(n=[],i=0,k=b.length;k>i;i++)e=b[i],n.push(this.on(e,c,d));return n}if("object"==typeof b){if(a._isEmpty(b))return!1;o=[];for(e in b)o.push(this.on(e,b[e],c||d));return o}if("string"!=typeof b)return!1;if("function"!=typeof c)return!1;for(null==(h=this.channels)[b]&&(h[b]=[]),g=this,m=this.channels[b],j=0,l=m.length;l>j;j++)if(f=m[j],f.callback===c&&f.context===d)return!1;return f={context:d,callback:c},{attach:function(){return g.channels[b].indexOf(f)>-1||g.channels[b].push(f),this},detach:function(){return a._remove(g,b,f.callback,void 0),this}}.attach()},a.prototype.off=function(b,c){var d;switch(typeof b){case"string":"function"==typeof c&&a._remove(this,b,c,void 0),"undefined"==typeof c&&a._remove(this,b,void 0,void 0);break;case"function":for(d in this.channels)a._remove(this,d,b,void 0);break;case"object":for(d in b)a._remove(this,d,b[d],void 0)}return this},a.prototype.emit=function(b,c,d){var e,f,g;return"string"!=typeof b?!1:("function"==typeof c&&(d=c,c=void 0),null==d&&(d=function(){}),f=this.channels[b]||[],g=function(){var a,d,g;for(g=[],a=0,d=f.length;d>a;a++)e=f[a],g.push(function(a){return function(d){var e;try{return d(void 0,a.callback.apply(a.context,[c,b]))}catch(f){return e=f,d(e)}}}(e));return g}(),a._runTasks(g,function(a,b){var c,e;return null!=a&&(c=function(){var b,c,d;for(d=[],b=0,c=a.length;c>b;b++)e=a[b],null!=e&&d.push(e);return d}(),console.error(c)),d(c,b)}),this)},a._isEmpty=function(a){var b;if(null==a)return!0;if(a.length>0)return!1;if(0===a.length)return!0;for(b in a)if(a.hasOwnProperty(b))return!1;return!0},a._remove=function(a,b,c,d){var e;if(null!=a.channels[b])return a.channels[b]=function(){var f,g,h,i;for(h=a.channels[b],i=[],f=0,g=h.length;g>f;f++)e=h[f],(null!=c?e.callback!==c:null!=d?e.context!==d:e.context!==a)&&i.push(e);return i}()},a._runTasks=function(a,b){var c,d,e,f;return null==a&&(a=[]),null==b&&(b=function(){}),d=-1,f=[],0===a.length?b(null):(c=null,(e=function(){var g,h,i;if(h=arguments[0],i=2<=arguments.length?j.call(arguments,1):[],h?(null==c&&(c=[]),c[d]=h):d>-1&&f.push(i.length<2?i[0]:i),++d>=a.length)return b(c,f);try{return a[d](e)}catch(k){return g=k,e(g)}})())},a}(),e=function(a,b,c){return typeof b!==a?""+c+" has to be a "+a:void 0},b=function(){function b(b){this.modules={},this.plugins={},this.bus=new a,this.API=b||c}return b.prototype.log={error:function(){var a,b,c,d;for(d=[],b=0,c=arguments.length;c>b;b++)a=arguments[b],d.push("undefined"!=typeof console&&null!==console?console.error(a):void 0);return d},warn:function(){var a,b,c,d;for(d=[],b=0,c=arguments.length;c>b;b++)a=arguments[b],d.push("undefined"!=typeof console&&null!==console?console.error(a):void 0);return d},log:function(){var a,b,c,d;for(d=[],b=0,c=arguments.length;c>b;b++)a=arguments[b],d.push("undefined"!=typeof console&&null!==console?console.log(a):void 0);return d},info:function(){}},b.prototype.register=function(a,b,c){var d;return null==c&&(c={}),(d=e("string",a,"module ID")||e("function",b,"creator")||e("object",c,"option parameter"))?(this.log.error("could not register module '"+a+"': "+d),this):a in this.modules?(this.log.warn("module "+a+" is already registered"),this):(this.modules[a]={moduleId:a,module:b,options:c},this)},b.prototype.start=function(a,b){var c,d=this;if(e("function",a,"onStarted")||(b=a,a=void 0),c=function(a,b){var c,e;if(null==b&&(b="initialize"),e=d.modules[a],!e.hasErrors)try{if(null==e.instance&&(e.api=new d.API(d),e.instance=new e.module(e.api)),null!=e.instance[b]&&!e.instance[b].processed)return e.instance[b](e.options),e.instance[b].processed=!0}catch(f){return c=f,delete e.instance,e.hasErrors=!0,d.log.error("module "+a+" failed to "+b,c)}},null!=a)return c(a,"initialize"),c(a,"postInitialize"),void("function"==typeof b&&b());for(a in this.modules)c(a,"initialize");for(a in this.modules)c(a,"postInitialize");return"function"==typeof b?b():void 0},b.prototype.stop=function(a,b){var c,d=this;if(e("function",a,"onStop")||(b=a,a=void 0),c=function(a){var b,c,e;if(c=d.modules[a],null!=c.instance)try{return"function"==typeof(e=c.instance).destroy&&e.destroy(),c.api.bus.__clear(),c.api=null,c.instance=null}catch(f){return b=f,d.log.error("module "+a+" failed to destroy")}},null!=a)return c(a),"function"==typeof b&&b(),this;for(a in this.modules)c(a);return this.bus.emit("stopped"),"function"==typeof b?b():void 0},b.prototype.use=function(a){var b,c,d,e,f,g,h;if(null==a)return this.log.warn("no plugin provided to use");if("function"==typeof a&&(a=new a(this.bus)),null==a.id)return this.log.error("plugin invalid, lack of 'id' property",a);if(null!=this.plugins[a.id])return this.log.warn("Plugin "+a.id+" already exist",a);if(null!=a.Facade){c=this.API._.extend({},a.Facade),d=new this.API;for(e in c)if(d.hasOwnProperty(e)){g=d[e]||{},f=a.Facade[e];for(h in f)if(g.hasOwnProperty(h))return this.log.error("plugin "+a.id+" declares facade attribute "+e+" that is already defined in the current facade");c[e]=this.API._.extend({},f,g)}}return this.plugins[a.id]=a,null!=c&&(b=this.API,this.API=this.API.extend({initialize:function(){var a,d;null!=(a=b.prototype.initialize)&&a.apply(this,arguments),d=[];for(e in c)d.push(this[e]=c[e]);return d}})),this},b.prototype.usePlugins=function(){var a,b,c,d;if(b=1<=arguments.length?j.call(arguments,0):[],null==b||0===b.length)return this.log.warn("no plugins provided to use");for(c=0,d=b.length;d>c;c++)a=b[c],this.use(a);return this},b}(),c=function(a){var b;return b=function(b,c){var d,e,f;return f=this,e=void 0,e=b&&a.has(b,"constructor")?b.constructor:function(){return f.apply(this,arguments)},a.extend(e,f,c),d=function(){this.constructor=e},d.prototype=f.prototype,e.prototype=new d,b&&a.extend(e.prototype,b),e.__super__=f.prototype,e},c=function(a){var b;return null!=(b=this.initialize)&&b.apply(this,arguments),this.bus={__listeners:{},__clear:function(){var a,b,c,d,e;for(a in this.__listeners)for(e=this.__listeners[a],c=0,d=e.length;d>c;c++)b=e[c],this.off(a,b);return this.__listeners={}},on:function(b,c,d){return a.bus.on(b,c,d),null==this.__listeners[b]&&(this.__listeners[b]=[]),this.__listeners[b].push(c)},off:function(b,c){var d;return a.bus.off(b,c),d=this.__listeners[b].indexOf[c],d>-1?this.__listeners[b].splice(d,1):void 0},emit:function(b,c,d){return a.bus.emit(b,c,d)}},this},c.extend=b,c._=a,c},g=g||{},(f=function(){var a,b,c,d,e,f,h,i,j,k,l,m,n,o;for(h=function(){},f=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],m="undefined"!=typeof window&&null!==window?window:{},a=m.console=m.console||{},n=0,o=f.length;o>n;n++)e=f[n],null==a[e]&&(a[e]=h);return j=a.error,a.error=function(){var a,b,d,e;for(a=[],d=0,e=arguments.length;e>d;d++)b=arguments[d],a.push(b),null!=b.stack&&a.push(b.stack);return j.apply(this,a),c.add("error",arguments)},k=a.log,a.log=function(){return k.apply(this,arguments),c.add("log",arguments)},l=a.warn,a.warn=function(){return l.apply(this,arguments),c.add("warn",arguments)},i=a.debug,a.debug=function(){return i.apply(this,arguments),c.add("debug",arguments)},a.dump=function(){return k.apply(this,arguments)},d=[],c={sizeLimit:500,add:function(a,b){return d.length>c.sizeLimit&&d.splice(0,.1*c.sizeLimit),d.push({level:a,time:(new Date).getTime(),messages:b})},list:function(){var b,c,e,f;for(f=[],c=0,e=d.length;e>c;c++)b=d[c],f.push(a.dump(b.time,b.level,b.messages));return f},getMessages:function(){return d},clear:function(){return d.length=0}},b={id:"logger",plugin:{logger:c},Facade:{logger:{list:c.list}}},g.logger=function(){return b}})(),h=function(d){return c(d),h={VERSION:"@@version",Bus:a,WebApp:b,Facade:c,plugins:g||{},modules:{}}},null!=("undefined"!=typeof define&&null!==define?define.amd:void 0)?define(["underscore","cast.bootstrap"],function(a,b){return h(a,b)}):"undefined"!=typeof window&&null!==window?window.stem=h(window._,window.bootstrap):null!=("undefined"!=typeof module&&null!==module?module.exports:void 0)&&(i=require("./base/3rdParties/underscore/1.6.0/underscore"),d=require("./base/assets/bootstrap/0.3.2/bootstrap.min"),module.exports=h(i,d))}).call(this);