Backbone.ModalView=Backbone.View.extend({name:"ModalView",modalBlanket:null,modalContainer:null,defaultOptions:{fadeInDuration:150,fadeOutDuration:150,showCloseButton:!0,bodyOverflowHidden:!1,setFocusOnFirstFormControl:!0,targetContainer:document.body,slideFromAbove:!1,slideFromBelow:!1,slideDistance:150,closeImageUrl:"resources/images/popup_close.png",closeImageHoverUrl:"resources/images/popup_close.png",showModalAtScrollPosition:!0,permanentlyVisible:!1,backgroundClickClosesModal:!0,pressingEscapeClosesModal:!0,css:{border:"1px solid","border-color":"#7a7a7A #000 #000","background-color":"#fff","-webkit-box-shadow":"0px 0px 15px 4px rgba(0, 0, 0, 0.5)","-moz-box-shadow":"0px 0px 15px 4px rgba(0, 0, 0, 0.5)","box-shadow":"0px 0px 15px 4px rgba(0, 0, 0, 0.5)","-webkit-border-radius":"10px","-moz-border-radius":"10px","border-radius":"10px"}},initialize:function(){},events:{},showModalBlanket:function(){return this.ensureModalBlanket().fadeIn(this.options.fadeInDuration)},hideModalBlanket:function(){return this.modalBlanket.fadeOut(this.options.fadeOutDuration)},ensureModalContainer:function(a){return null!=a&&null!=this.modalContainer&&(this.modalContainer.remove(),this.modalContainer=null),null==this.modalContainer&&(this.modalContainer=$("<div id='modalContainer'>").css({"z-index":"99999",position:"relative","-webkit-border-radius":"6px","-moz-border-radius":"6px","border-radius":"6px"}).appendTo(a)),this.modalContainer},ensureModalBlanket:function(){return this.modalBlanket=$("#modal-blanket"),0==this.modalBlanket.length?this.modalBlanket=$("<div id='modal-blanket'>").css({position:"absolute",top:0,left:0,height:$(document).height(),width:"100%",opacity:.5,backgroundColor:"#000","z-index":99900}).appendTo(document.body).hide():this.modalBlanket.css({height:$(document).height(),width:"100%"}),this.modalBlanket},keyup:function(a){27==a.keyCode&&this.options.pressingEscapeClosesModal&&this.hideModal()},click:function(a){"modal-blanket"==a.target.id&&this.options.backgroundClickClosesModal&&this.hideModal()},setFocusOnFirstFormControl:function(){var a=$("input, select, email, url, number, range, date, month, week, time, datetime, datetime-local, search, color",$(this.el));a.length>0&&$(a[0]).focus()},hideModal:function(){this.trigger("closeModalWindow"),this.hideModalBlanket(),$(document.body).unbind("keyup",this.keyup),this.modalBlanket.unbind("click",this.click),this.options.bodyOverflowHidden===!0&&$(document.body).css("overflow",this.originalBodyOverflowValue);var a=this.modalContainer;$(this.modalContainer).fadeOut(this.options.fadeOutDuration,function(){a.remove()})},getCoordinate:function(a,b){if("undefined"!=typeof b[a]){var c=b[a];return delete b[a],c}},recenter:function(){var a=$(this.el),b=({top:this.getCoordinate("top",this.options.css),left:this.getCoordinate("left",this.options.css),right:this.getCoordinate("right",this.options.css),bottom:this.getCoordinate("bottom",this.options.css),isEmpty:function(){return null==this.top&&null==this.left&&null==this.right&&null==this.bottom}},this.getOffsets()),c=$(window).height()/2,d=$(window).width()/2,e=this.modalContainer,f=c-a.outerHeight()/2;e.css({top:f+b.y+"px"});var g=d-a.outerWidth()/2;return e.css({left:g+b.x+"px"}),this},getOffsets:function(){var a=0,b=0;return this.options.showModalAtScrollPosition&&(a=$(document).scrollTop(),b=$(document).scrollLeft()),{x:b,y:a}},showModal:function(a){this.defaultOptions.targetContainer=document.body,this.options=$.extend(!0,{},this.defaultOptions,a,this.options),this.options.permanentlyVisible&&(this.options.showCloseButton=!1,this.options.backgroundClickClosesModal=!1,this.options.pressingEscapeClosesModal=!1);var b=$(this.el),c=$(window).height()/2,d=$(window).width()/2,e=this.ensureModalContainer(this.options.targetContainer).empty();b.addClass("modal");var f={top:this.getCoordinate("top",this.options.css),left:this.getCoordinate("left",this.options.css),right:this.getCoordinate("right",this.options.css),bottom:this.getCoordinate("bottom",this.options.css),isEmpty:function(){return null==this.top&&null==this.left&&null==this.right&&null==this.bottom}};b.css(this.options.css),this.showModalBlanket(),this.keyup=_.bind(this.keyup,this),this.click=_.bind(this.click,this),$(document.body).keyup(this.keyup),this.modalBlanket.click(this.click),this.options.bodyOverflowHidden===!0&&(this.originalBodyOverflowValue=$(document.body).css("overflow"),$(document.body).css("overflow","hidden")),e.append(b),e.css({opacity:0,position:"absolute","z-index":999999});var g=this.getOffsets();if(f.isEmpty()){var h=c-b.outerHeight()/2;10>h&&(h=10),"undefined"!=typeof this.options.y?h=this.options.y:h+=g.y,e.css({top:h+"px"});var i=d-b.outerWidth()/2;"undefined"!=typeof this.options.x?i=this.options.x:i+=g.x,e.css({left:i+"px"})}else null!=f.top&&e.css({top:f.top+g.y}),null!=f.left&&e.css({left:f.left+g.x}),null!=f.right&&e.css({right:f.right}),null!=f.bottom&&e.css({bottom:f.bottom});if(this.options.setFocusOnFirstFormControl&&this.setFocusOnFirstFormControl(),this.options.showCloseButton){var j=this;$("<a href='#' id='modalCloseButton'>&#160;</a>").css({position:"absolute",top:"-25px",right:"-25px",width:"52px",height:"52px",background:"transparent url("+j.options.closeImageUrl+") top left no-repeat","background-size":"52px 52px","text-decoration":"none"}).appendTo(this.modalContainer).hover(function(){$(this).css("background-image","url("+j.options.closeImageHoverUrl+") !important")},function(){$(this).css("background-image","url("+j.options.closeImageUrl+") !important")}).click(function(a){a.preventDefault(),j.hideModal()})}var k=this,l=function(){k.recenter()};$(window).resize(l),b.on("remove",function(){$(window).off("resize",l)});var m={opacity:1},n=e.offset();return this.options.slideFromAbove&&(e.css({top:n.top-this.options.slideDistance+"px"}),m.top=f.top),this.options.slideFromBelow&&(e.css({top:n.top+this.options.slideDistance+"px"}),m.top=f.top),this.modalContainer.animate(m,this.options.fadeInDuration),this}});
//# sourceMappingURL=backbone-modaldialog.min.map