{
    "id": 1039006,
    "name": "Avoid using predictable SecureRandom Seeds",
    "href": "AIP/quality-rules/1039006",
    "critical": true,
    "associatedValueName": "Number of violation occurrences",
    "description": "This rule reports violation when SecureRandom.setSeed() or SecureRandom(byte[]) are called with a seed that is either of: \n\n- constant \n- System.currentTimeMillis()",
    "output": "Associated to each violation, the following information is provided:\n- The number of violation occurrences\n- Bookmarks for violation occurrences found in the source code",
    "rationale": "The java.security.SecureRandom class provides a strong random number generator (RNG) appropriate for cryptography. However, seeding it with a constant or another predictable value will weaken it significantly. In general, it is much safer to rely on the seed provided by the SecureRandom implementation. \n\nThe use of predictable seeds significantly reduces the number of possible seeds that an attacker would need to test in order to predict which random numbers will be generated by the RNG",
    "reference": "http://cwe.mitre.org/data/definitions/337.html \nhttp://cwe.mitre.org/data/definitions/336.html",
    "remediation": "Use of predictable seeds is not recommended.",
    "remediationSample": "SecureRandom sr = new SecureRandom(); \nint v = sr.next(32) // Violation FIXED",
    "sample": "# Sample 1\nSecureRandom sr = new SecureRandom(); \nsr.setSeed(123456L); // VIOLATION \nint v = sr.next(32); \n\nsr = new SecureRandom(\"abcdefghijklmnop\".getBytes(\"us-ascii\")); // VIOLATION \nv = sr.next(32); \n\n# Sample 2 \nRandom random = new Random(System.currentTimeMillis()); // VIOLATION \nint accountID = random.nextInt();",
    "total": "Number of Java artifacts",
    "alternativeName": "Ensure that you are not using predictable SecureRandom Seeds",
    "businessCriteria": [
        {
            "id": 20140522,
            "name": "Green Stuff",
            "href": "AIP/business-criteria/20140522"
        },
        {
            "id": 66031,
            "name": "Programming Practices",
            "href": "AIP/business-criteria/66031"
        },
        {
            "id": 60013,
            "name": "Robustness",
            "href": "AIP/business-criteria/60013"
        },
        {
            "id": 60016,
            "name": "Security",
            "href": "AIP/business-criteria/60016"
        }
    ],
    "technicalCriteria": [
        {
            "id": 66065,
            "name": "Secure Coding - Time and State",
            "weight": 7,
            "critical": true
        }
    ],
    "technologies": [
        {
            "id": 140029,
            "name": "JEE",
            "href": "AIP/technologies/140029"
        }
    ],
    "qualityStandards": [
        {
            "standard": "CWE",
            "id": "CWE-336",
            "name": "Same Seed in Pseudo-Random Number Generator (PRNG)",
            "url": null,
            "description": null
        },
        {
            "standard": "CWE",
            "id": "CWE-337",
            "name": "Predictable Seed in Pseudo-Random Number Generator (PRNG)",
            "url": null,
            "description": null
        },
        {
            "standard": "OWASP",
            "id": "A5-2013",
            "name": "Security Misconfiguration",
            "url": null,
            "description": null
        },
        {
            "standard": "OWASP",
            "id": "A6-2017",
            "name": "Security Misconfiguration",
            "url": null,
            "description": null
        },
        {
            "standard": "STIG-V4R8",
            "id": "STIG-V-70245",
            "name": "The application must protect the confidentiality and integrity of transmitted information.",
            "url": null,
            "description": null
        }
    ],
    "parameters": [
        
    ],
    "thresholds": [
        50.0,
        90.0,
        95.0,
        99.0
    ]
}
